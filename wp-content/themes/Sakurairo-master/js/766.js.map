{"version":3,"sources":["webpack://sakurairo-scripts/./node_modules/@sliphua/pjax/dist/pjax.esm.js"],"names":["__webpack_modules__","__unused_webpack___webpack_module__","__webpack_exports__","_classPrivateMethodGet","receiver","privateSet","fn","has","TypeError","r","d","_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","__unused_webpack_module","_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__","_babel_runtime_helpers_classPrivateMethodGet__WEBPACK_IMPORTED_MODULE_1__","_save","WeakSet","_sign","_save2","window","sessionStorage","setItem","this","sessionKey","JSON","stringify","state","_sign2","history","default","call","idPrefix","count","attached","historyKey","__WEBPACK_DEFAULT_EXPORT__","add","replaceState","document","title","url","pushState","_window$history$state","parse","getItem","MIMETypes","scriptEle","evaluable","external","target","hasAttribute","text","typeString","type","trim","includes","noModule","src","getAttribute","URL","blocking","Promise","resolve","reject","oldEle","newEle","createElement","addEventListener","getAttributeNames","forEach","name","setAttribute","async","defer","contains","replaceWith","head","append","remove","_Script__WEBPACK_IMPORTED_MODULE_0__","Executor","signal","script","_this$signal","aborted","DOMException","evalPromise","eval","catch","executeScripts","scriptEleList","validScripts","Array","from","filter","executor","execution","reduce","promise","all","exec","then","race","_libs_executeScripts__WEBPACK_IMPORTED_MODULE_0__","preparePage","switchResult","overrideOptions","options","_this$abortController","_document$querySelect","focusCleared","querySelectorAll","focus","scripts","node","HTMLScriptElement","selectors","selector","body","element","push","sort","a","b","compareDocumentPosition","Node","DOCUMENT_POSITION_PRECEDING","abortController","scrollTo","parsedScrollTo","isArray","scrollX","hashId","decodeURIComponent","location","hash","slice","getElementById","getElementsByName","scrollIntoView","_utils_switchNodes__WEBPACK_IMPORTED_MODULE_0__","switchDOM","switches","timeout","eventDetail","parsedURL","targetURL","href","request","Request","headers","timeoutID","setTimeout","_this$abortController2","abort","fire","response","fetch","finally","clearTimeout","newDocument","DOMParser","parseFromString","newLocation","error","getLink","ele","checkingEle","links","parent","parentElement","DefaultTrigger","pjax","event","link","defaultPrevented","MouseEvent","KeyboardEvent","metaKey","ctrlKey","shiftKey","altKey","origin","preventDefault","loadURL","onLinkOpen","Switches","oldNode","newNode","innerHTML","textContent","innerText","existingNames","existing","removeAttribute","_Switches__WEBPACK_IMPORTED_MODULE_0__","switchNodes","sourceDocument","switchesList","sourceNodeList","targetNodeList","length","targetNode","index","activeElement","blur","targetSwitch","switchPromise","outcomes","weakLoadURL","storeScrollPosition","AbortController","pathname","search","pull","__webpack_module_cache__","moduleId","cachedModule","undefined","exports","module","definition","o","get","prop","prototype","hasOwnProperty","Symbol","toStringTag","_libs_LazyHistory__WEBPACK_IMPORTED_MODULE_1__","_utils_Switches__WEBPACK_IMPORTED_MODULE_2__","_utils_DefaultTrigger__WEBPACK_IMPORTED_MODULE_3__","_switchDOM__WEBPACK_IMPORTED_MODULE_4__","_preparePage__WEBPACK_IMPORTED_MODULE_5__","_weakLoadURL__WEBPACK_IMPORTED_MODULE_6__","Pjax","reload","defaultTrigger","scrollRestoration","cacheMode","assign","register","scrollPos","scrollY","detail","CustomEvent","bubbles","cancelable","dispatchEvent","e","__webpack_exports__default"],"mappings":"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","file":"766.js","sourcesContent":["/******/ \"use strict\";\n/******/ var __webpack_modules__ = ({\n\n/***/ \"./node_modules/@babel/runtime/helpers/esm/classPrivateMethodGet.js\":\n/*!**************************************************************************!*\\\n  !*** ./node_modules/@babel/runtime/helpers/esm/classPrivateMethodGet.js ***!\n  \\**************************************************************************/\n/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ _classPrivateMethodGet)\n/* harmony export */ });\nfunction _classPrivateMethodGet(receiver, privateSet, fn) {\n  if (!privateSet.has(receiver)) {\n    throw new TypeError(\"attempted to get private field on non-instance\");\n  }\n\n  return fn;\n}\n\n/***/ }),\n\n/***/ \"./node_modules/@babel/runtime/helpers/esm/defineProperty.js\":\n/*!*******************************************************************!*\\\n  !*** ./node_modules/@babel/runtime/helpers/esm/defineProperty.js ***!\n  \\*******************************************************************/\n/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {\n\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ _defineProperty)\n/* harmony export */ });\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\n/***/ }),\n\n/***/ \"./src/libs/LazyHistory/index.js\":\n/*!***************************************!*\\\n  !*** ./src/libs/LazyHistory/index.js ***!\n  \\***************************************/\n/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {\n\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ \"./node_modules/@babel/runtime/helpers/esm/defineProperty.js\");\n/* harmony import */ var _babel_runtime_helpers_classPrivateMethodGet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/classPrivateMethodGet */ \"./node_modules/@babel/runtime/helpers/esm/classPrivateMethodGet.js\");\n\n\n\nvar _save = /*#__PURE__*/new WeakSet();\n\nvar _sign = /*#__PURE__*/new WeakSet();\n\n/**\n * Lazy Session History API\n * ===\n * Access the associated data of a history entry even after user navigations.\n *\n * On page navigation events (like popstate), `window.history.state` has already been changed and\n * we can't update the previous state anymore. To leave a last mark on the leaving page, we have to\n * either keep updating the state continuously - which usually causes performance issues,\n * or make use of other API.\n *\n * Internally, this module uses **session storage** to store data, and uses browsers' original\n * history state as keys to identify session storage items.\n */\n\n/**\n * A valid state object.\n * @typedef {Object<string, any>} State\n */\nclass LazyHistory {\n  /**\n   * The prefix of the generated key.\n   * @type {string}\n   */\n\n  /**\n   * Used to generate unique keys.\n   * @type {number}\n   */\n\n  /**\n   * The key used in `window.history.state`.\n   * @type {string}\n   */\n\n  /**\n   * The session key reflecting the current state.\n   * @type {string}\n   */\n\n  /**\n   * The current state.\n   * @type {State}\n   */\n\n  /**\n   * @param {string} idPrefix\n   * @param {string} historyKey\n   */\n  constructor(idPrefix, historyKey = idPrefix) {\n    _sign.add(this);\n\n    _save.add(this);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"idPrefix\", void 0);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"count\", 0);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"historyKey\", void 0);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"sessionKey\", void 0);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"state\", void 0);\n\n    this.idPrefix = idPrefix;\n    this.historyKey = historyKey; // Initialize current history entry.\n\n    window.history.replaceState((0,_babel_runtime_helpers_classPrivateMethodGet__WEBPACK_IMPORTED_MODULE_1__.default)(this, _sign, _sign2).call(this), document.title);\n  }\n  /**\n   * Save current state to session storage.\n   */\n\n\n  /**\n   * Push to history entry.\n   * @param {?State} state\n   * @param {string} title\n   * @param {string} url\n   */\n  push(state, title, url) {\n    window.history.pushState((0,_babel_runtime_helpers_classPrivateMethodGet__WEBPACK_IMPORTED_MODULE_1__.default)(this, _sign, _sign2).call(this, state), title, url);\n  }\n  /**\n   * Keep up with current browser history entry.\n   */\n\n\n  pull() {\n    var _window$history$state;\n\n    (0,_babel_runtime_helpers_classPrivateMethodGet__WEBPACK_IMPORTED_MODULE_1__.default)(this, _save, _save2).call(this);\n\n    const sessionKey = (_window$history$state = window.history.state) === null || _window$history$state === void 0 ? void 0 : _window$history$state[this.historyKey];\n\n    if (!sessionKey) {\n      // Initialize if haven't.\n      window.history.replaceState((0,_babel_runtime_helpers_classPrivateMethodGet__WEBPACK_IMPORTED_MODULE_1__.default)(this, _sign, _sign2).call(this), document.title);\n    } else {\n      this.sessionKey = sessionKey;\n      this.state = JSON.parse(window.sessionStorage.getItem(sessionKey));\n    }\n  }\n\n}\n\nfunction _save2() {\n  window.sessionStorage.setItem(this.sessionKey, JSON.stringify(this.state));\n}\n\nfunction _sign2(state = window.history.state) {\n  (0,_babel_runtime_helpers_classPrivateMethodGet__WEBPACK_IMPORTED_MODULE_1__.default)(this, _save, _save2).call(this); // Generate a new key.\n\n\n  const sessionKey = `${this.idPrefix}_${this.count}`;\n  this.count += 1; // Generate attached state.\n\n  const attached = { ...(state || {}),\n    [this.historyKey]: sessionKey\n  };\n  this.sessionKey = sessionKey;\n  this.state = attached;\n  return attached;\n}\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (LazyHistory);\n\n/***/ }),\n\n/***/ \"./src/libs/executeScripts/Script.js\":\n/*!*******************************************!*\\\n  !*** ./src/libs/executeScripts/Script.js ***!\n  \\*******************************************/\n/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {\n\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/**\n * Follow\n * https://html.spec.whatwg.org/multipage/scripting.html#prepare-a-script\n * excluding steps concerning obsoleted attributes.\n */\n\n/**\n * JavaScript MIME type strings.\n */\nconst MIMETypes = ['application/ecmascript', 'application/javascript', 'application/x-ecmascript', 'application/x-javascript', 'text/ecmascript', 'text/javascript', 'text/javascript1.0', 'text/javascript1.1', 'text/javascript1.2', 'text/javascript1.3', 'text/javascript1.4', 'text/javascript1.5', 'text/jscript', 'text/livescript', 'text/x-ecmascript', 'text/x-javascript'];\n\nclass Script {\n  constructor(scriptEle) {\n    this.evaluable = false;\n    this.external = false;\n    this.target = scriptEle; // Process empty.\n\n    if (!scriptEle.hasAttribute('src') && !scriptEle.text) return; // Process type.\n\n    const typeString = scriptEle.type ? scriptEle.type.trim() : 'text/javascript';\n\n    if (MIMETypes.includes(typeString)) {\n      this.type = 'classic';\n    } else if (typeString === 'module') {\n      this.type = 'module';\n    } else {\n      return;\n    } // Process no module.\n\n\n    if (scriptEle.noModule && this.type === 'classic') {\n      return;\n    } // Process external.\n\n\n    if (scriptEle.hasAttribute('src')) {\n      const src = scriptEle.getAttribute('src'); // An empty src attribute not results in external status\n      // and the script is not executable.\n\n      if (!src) return;\n      this.external = true;\n\n      try {\n        // eslint-disable-next-line no-new\n        new URL(src, document.URL);\n      } catch {\n        return;\n      }\n    } // Process blocking.\n\n\n    this.blocking = true;\n\n    if (this.type !== 'classic') {\n      this.blocking = false;\n    } else if (this.external) {\n      if (scriptEle.hasAttribute('async')) {\n        this.blocking = false;\n      } else if (scriptEle.hasAttribute('defer')) {\n        this.blocking = false;\n      }\n    }\n\n    this.evaluable = true;\n  }\n\n  eval() {\n    return new Promise((resolve, reject) => {\n      const oldEle = this.target;\n      const newEle = document.createElement('script');\n      newEle.addEventListener('error', reject); // Clone attributes and inner text.\n\n      oldEle.getAttributeNames().forEach(name => {\n        newEle.setAttribute(name, oldEle.getAttribute(name));\n      });\n      newEle.text = oldEle.text;\n\n      if (this.external) {\n        // Reset async of external scripts to force synchronous loading.\n        // Needed since it defaults to true on dynamically injected scripts.\n        if (!newEle.hasAttribute('async')) newEle.async = false; // Defer a dynamically inserted script is meaningless\n        // and may cause the script not to be executed in some environments.\n\n        newEle.defer = false;\n      } // Execute.\n\n\n      if (document.contains(oldEle)) {\n        oldEle.replaceWith(newEle);\n      } else {\n        // Execute in <head> if it's not in current document.\n        document.head.append(newEle);\n\n        if (this.external) {\n          newEle.addEventListener('load', () => newEle.remove());\n        } else {\n          newEle.remove();\n        }\n      }\n\n      if (this.external) {\n        newEle.addEventListener('load', resolve);\n      } else {\n        resolve();\n      }\n    });\n  }\n\n}\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Script);\n\n/***/ }),\n\n/***/ \"./src/libs/executeScripts/index.js\":\n/*!******************************************!*\\\n  !*** ./src/libs/executeScripts/index.js ***!\n  \\******************************************/\n/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {\n\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ executeScripts)\n/* harmony export */ });\n/* harmony import */ var _Script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Script */ \"./src/libs/executeScripts/Script.js\");\n\n\nclass Executor {\n  /**\n   * @param {?AbortSignal} signal\n   */\n  constructor(signal) {\n    this.signal = signal;\n  }\n  /**\n   * Execute script.\n   * Throw only when aborted.\n   * Wait only for blocking script.\n   * @param {Script} script\n   */\n\n\n  async exec(script) {\n    var _this$signal;\n\n    if ((_this$signal = this.signal) !== null && _this$signal !== void 0 && _this$signal.aborted) throw new DOMException('Execution aborted', 'AbortError');\n    const evalPromise = script.eval().catch(() => {});\n    if (script.blocking) await evalPromise;\n  }\n\n}\n/**\n * Find and execute scripts in order.\n * Needed since innerHTML does not run scripts.\n * @param {Iterable<HTMLScriptElement>} scriptEleList\n * @param {Object} [options]\n * @param {AbortSignal} [options.signal]\n */\n\n\nasync function executeScripts(scriptEleList, {\n  signal\n} = {}) {\n  if (signal !== null && signal !== void 0 && signal.aborted) throw new DOMException('Aborted execution', 'AbortError');\n  const validScripts = Array.from(scriptEleList, scriptEle => new _Script__WEBPACK_IMPORTED_MODULE_0__.default(scriptEle)).filter(script => script.evaluable);\n  const executor = new Executor(signal); // Evaluate external scripts first\n  // to help browsers fetch them in parallel.\n  // Each inline blocking script will be evaluated as soon as\n  // all its previous blocking scripts are executed.\n\n  const execution = validScripts.reduce((promise, script) => {\n    if (script.external) {\n      return Promise.all([promise, executor.exec(script)]);\n    }\n\n    return promise.then(() => executor.exec(script));\n  }, Promise.resolve()); // Reject as soon as possible on abort.\n\n  return Promise.race([execution, new Promise((resolve, reject) => {\n    signal === null || signal === void 0 ? void 0 : signal.addEventListener('abort', () => {\n      reject(new DOMException('Aborted execution', 'AbortError'));\n    });\n  })]);\n}\n\n/***/ }),\n\n/***/ \"./src/preparePage.js\":\n/*!****************************!*\\\n  !*** ./src/preparePage.js ***!\n  \\****************************/\n/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {\n\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ preparePage)\n/* harmony export */ });\n/* harmony import */ var _libs_executeScripts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./libs/executeScripts */ \"./src/libs/executeScripts/index.js\");\n\n/**\n * After page elements are updated.\n * @this {Pjax}\n * @param {?SwitchResult} switchResult\n * @param {Partial<Pjax.options>} [overrideOptions]\n * @return {Promise<void>}\n */\n\nasync function preparePage(switchResult, overrideOptions = {}) {\n  const options = { ...this.options,\n    ...overrideOptions\n  }; // If page elements are switched.\n\n  if (switchResult) {\n    var _this$abortController;\n\n    // Focus the FIRST autofocus if the previous focus is cleared.\n    // https://html.spec.whatwg.org/multipage/interaction.html#the-autofocus-attribute\n    if (switchResult.focusCleared) {\n      var _document$querySelect;\n\n      (_document$querySelect = document.querySelectorAll('[autofocus]')[0]) === null || _document$querySelect === void 0 ? void 0 : _document$querySelect.focus();\n    } // List newly added and labeled scripts\n\n\n    const scripts = [...document.querySelectorAll(options.scripts)].filter(node => node instanceof HTMLScriptElement);\n    options.selectors.forEach(selector => {\n      document.body.querySelectorAll(selector).forEach(element => {\n        element.querySelectorAll('script').forEach(script => {\n          if (scripts.includes(script)) return;\n          scripts.push(script);\n        });\n      });\n    }); // Sort by document position.\n    // https://stackoverflow.com/a/22613028\n\n    scripts.sort((a, b) => // Bitwise AND operator is required here.\n    // eslint-disable-next-line no-bitwise\n    a.compareDocumentPosition(b) & Node.DOCUMENT_POSITION_PRECEDING || -1); // Execute.\n\n    await (0,_libs_executeScripts__WEBPACK_IMPORTED_MODULE_0__.default)(scripts, {\n      signal: (_this$abortController = this.abortController) === null || _this$abortController === void 0 ? void 0 : _this$abortController.signal\n    });\n  } // Parse required scroll position.\n\n\n  const {\n    scrollTo\n  } = options; // When scroll is allowed.\n\n  if (scrollTo !== false) {\n    // If switched, default to left top. Otherwise, default to no scroll.\n    let parsedScrollTo = switchResult ? [0, 0] : false;\n\n    if (Array.isArray(scrollTo)) {\n      parsedScrollTo = scrollTo;\n    } else if (typeof scrollTo === 'number') {\n      parsedScrollTo = [window.scrollX, scrollTo];\n    } else {\n      // Parse target.\n      const hashId = decodeURIComponent(window.location.hash.slice(1));\n\n      if (hashId) {\n        const target = document.getElementById(hashId) || document.getElementsByName(hashId)[0];\n\n        if (target) {\n          target.scrollIntoView();\n          parsedScrollTo = false;\n        }\n      }\n    } // Scroll.\n\n\n    if (parsedScrollTo) window.scrollTo(parsedScrollTo[0], parsedScrollTo[1]);\n  }\n}\n\n/***/ }),\n\n/***/ \"./src/switchDOM.js\":\n/*!**************************!*\\\n  !*** ./src/switchDOM.js ***!\n  \\**************************/\n/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {\n\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ switchDOM)\n/* harmony export */ });\n/* harmony import */ var _utils_switchNodes__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/switchNodes */ \"./src/utils/switchNodes.js\");\n\n/**\n * @this {Pjax}\n * @param {string} url\n * @param {Partial<Pjax.options>} [overrideOptions]\n * @return {Promise<void>}\n */\n\nasync function switchDOM(url, overrideOptions = {}) {\n  var _this$abortController;\n\n  const {\n    selectors,\n    switches,\n    timeout\n  } = { ...this.options,\n    ...overrideOptions\n  };\n  const eventDetail = {};\n  const parsedURL = new URL(url, document.URL);\n  eventDetail.targetURL = parsedURL.href;\n  const signal = ((_this$abortController = this.abortController) === null || _this$abortController === void 0 ? void 0 : _this$abortController.signal) || null;\n  eventDetail.signal = signal;\n  eventDetail.selectors = selectors;\n  const request = new Request(parsedURL.href, {\n    headers: {\n      'X-Requested-With': 'Fetch',\n      'X-Pjax': 'true',\n      'X-Pjax-Selectors': JSON.stringify(selectors)\n    },\n    signal\n  }); // Set timeout\n\n  eventDetail.timeout = timeout;\n  let timeoutID = null;\n\n  if (timeout > 0) {\n    timeoutID = window.setTimeout(() => {\n      var _this$abortController2;\n\n      (_this$abortController2 = this.abortController) === null || _this$abortController2 === void 0 ? void 0 : _this$abortController2.abort();\n    }, timeout);\n    eventDetail.timeoutID = timeoutID;\n  }\n\n  this.fire('send', eventDetail);\n\n  try {\n    const response = await fetch(request).finally(() => {\n      window.clearTimeout(timeoutID);\n    }); // Switch before changing URL.\n\n    const newDocument = new DOMParser().parseFromString(await response.text(), 'text/html');\n    eventDetail.switches = switches;\n    const switchResult = await (0,_utils_switchNodes__WEBPACK_IMPORTED_MODULE_0__.default)(newDocument, {\n      selectors,\n      switches,\n      signal\n    });\n    eventDetail.switchResult = switchResult; // Update window location. Preserve hash as the fetch discards it.\n\n    const newLocation = new URL(response.url);\n    newLocation.hash = parsedURL.hash;\n\n    if (window.location.href !== newLocation.href) {\n      window.history.pushState({}, document.title, newLocation.href);\n    } // Simulate initial page load.\n\n\n    await this.preparePage(switchResult, overrideOptions);\n  } catch (error) {\n    eventDetail.error = error;\n    this.fire('error', eventDetail);\n    throw error;\n  } finally {\n    this.fire('complete', eventDetail);\n  }\n\n  this.fire('success', eventDetail);\n}\n\n/***/ }),\n\n/***/ \"./src/utils/DefaultTrigger.js\":\n/*!*************************************!*\\\n  !*** ./src/utils/DefaultTrigger.js ***!\n  \\*************************************/\n/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {\n\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ DefaultTrigger)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ \"./node_modules/@babel/runtime/helpers/esm/defineProperty.js\");\n\n\n/**\n * @typedef {HTMLAnchorElement|HTMLAreaElement} Link\n */\nconst getLink = ele => {\n  let checkingEle = ele;\n  const links = [...document.links];\n\n  while (!links.includes(checkingEle)) {\n    const parent = checkingEle.parentElement;\n    if (!parent) return null;\n    checkingEle = parent;\n  }\n\n  return checkingEle;\n};\n\nclass DefaultTrigger {\n  /**\n   * @param {Pjax} pjax\n   */\n  constructor(pjax) {\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"pjax\", void 0);\n\n    this.pjax = pjax;\n  }\n  /**\n   * @param {Event} event\n   * @param {Link} link\n   */\n\n\n  onLinkOpen(event, link) {\n    if (event.defaultPrevented) return;\n\n    if (event instanceof MouseEvent || event instanceof KeyboardEvent) {\n      if (event.metaKey || event.ctrlKey || event.shiftKey || event.altKey) return;\n    } // External.\n    // loadURL checks external but without browsers' attribute related support.\n\n\n    if (link.origin !== window.location.origin) return;\n    event.preventDefault();\n    this.pjax.loadURL(link.href).catch(() => {});\n  }\n\n  register() {\n    document.addEventListener('click', event => {\n      const link = getLink(event.target);\n      if (!link) return;\n      this.onLinkOpen(event, link);\n    });\n    document.addEventListener('keyup', event => {\n      if (event.key !== 'Enter') return;\n      const link = getLink(event.target);\n      if (!link) return;\n      this.onLinkOpen(event, link);\n    });\n  }\n\n}\n\n/***/ }),\n\n/***/ \"./src/utils/Switches.js\":\n/*!*******************************!*\\\n  !*** ./src/utils/Switches.js ***!\n  \\*******************************/\n/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {\n\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/**\n * @type {Readonly<Object<string, Pjax.Switch>>}\n */\nconst Switches = {\n  /**\n   * Replace HTML contents by using innerHTML.\n   * @param oldNode {Element}\n   * @param newNode {Element}\n   * @returns {Promise<void>}\n   */\n  async innerHTML(oldNode, newNode) {\n    // eslint-disable-next-line no-param-reassign\n    oldNode.innerHTML = newNode.innerHTML;\n  },\n\n  /**\n   * Replace all text by using textContent.\n   * @param oldNode {Node}\n   * @param newNode {Node}\n   * @returns {Promise<void>}\n   */\n  async textContent(oldNode, newNode) {\n    // eslint-disable-next-line no-param-reassign\n    oldNode.textContent = newNode.textContent;\n  },\n\n  /**\n   * Replace readable text by using innerText.\n   * @param oldEle {HTMLElement}\n   * @param newEle {HTMLElement}\n   * @returns {Promise<void>}\n   */\n  async innerText(oldEle, newEle) {\n    // eslint-disable-next-line no-param-reassign\n    oldEle.innerText = newEle.innerText;\n  },\n\n  /**\n   * Rewrite all attributes.\n   * @param oldEle {Element}\n   * @param newEle {Element}\n   * @returns {Promise<void>}\n   */\n  async attributes(oldEle, newEle) {\n    let existingNames = oldEle.getAttributeNames();\n    const targetNames = newEle.getAttributeNames();\n    targetNames.forEach(target => {\n      oldEle.setAttribute(target, newEle.getAttribute(target));\n      existingNames = existingNames.filter(existing => existing !== target);\n    });\n    existingNames.forEach(existing => {\n      oldEle.removeAttribute(existing);\n    });\n  },\n\n  /**\n   * Replace the whole element by using replaceWith.\n   * @param oldNode {ChildNode}\n   * @param newNode {ChildNode}\n   * @returns {Promise<void>}\n   */\n  async replaceWith(oldNode, newNode) {\n    oldNode.replaceWith(newNode);\n  }\n\n};\nSwitches.default = Switches.replaceWith;\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Switches);\n\n/***/ }),\n\n/***/ \"./src/utils/switchNodes.js\":\n/*!**********************************!*\\\n  !*** ./src/utils/switchNodes.js ***!\n  \\**********************************/\n/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {\n\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ switchNodes)\n/* harmony export */ });\n/* harmony import */ var _Switches__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Switches */ \"./src/utils/Switches.js\");\n\n/**\n * @callback Pjax.Switch\n * @param {Node} oldNode\n * @param {Node} newNode\n * @return {Promise<any>|void}\n */\n\n/**\n * @typedef {Object} SwitchResult\n * @property {boolean} focusCleared\n * @property {Array<*>} outcomes\n */\n\n/**\n * @param {Document} sourceDocument\n * @param {Object} options\n * @param {Array<string>} options.selectors\n * @param {Object<string, Pjax.Switch>} [options.switches]\n * @param {AbortSignal} [options.signal]\n * @return {Promise<SwitchResult>}\n */\n\nasync function switchNodes(sourceDocument, {\n  selectors,\n  switches,\n  signal\n}) {\n  if (signal !== null && signal !== void 0 && signal.aborted) throw new DOMException('Aborted switches', 'AbortError');\n  let focusCleared = false;\n  const switchesList = [];\n  selectors.forEach(selector => {\n    const sourceNodeList = sourceDocument.querySelectorAll(selector);\n    const targetNodeList = document.querySelectorAll(selector); // Throw when the structure is not match.\n\n    if (sourceNodeList.length !== targetNodeList.length) {\n      throw new DOMException(`Selector '${selector}' does not select the same amount of nodes`, 'IndexSizeError');\n    } // Start switching for each match.\n\n\n    targetNodeList.forEach((targetNode, index) => {\n      // Clear out focused controls before switching.\n      if (!focusCleared && document.activeElement && targetNode.contains(document.activeElement)) {\n        document.activeElement.blur();\n        focusCleared = true;\n      } // Argument defined switch is prior to default switch.\n\n\n      const targetSwitch = (switches === null || switches === void 0 ? void 0 : switches[selector]) || _Switches__WEBPACK_IMPORTED_MODULE_0__.default.default; // Start switching. Package to promise. Ignore switch errors.\n\n      const switchPromise = Promise.resolve().then(() => targetSwitch(targetNode, sourceNodeList[index])).catch(() => {});\n      switchesList.push(switchPromise);\n    });\n  }); // Reject as soon as possible on abort.\n\n  const outcomes = await Promise.race([Promise.all(switchesList), new Promise((resolve, reject) => {\n    signal === null || signal === void 0 ? void 0 : signal.addEventListener('abort', () => {\n      reject(new DOMException('Aborted switches', 'AbortError'));\n    });\n  })]);\n  return {\n    focusCleared,\n    outcomes\n  };\n}\n\n/***/ }),\n\n/***/ \"./src/weakLoadURL.js\":\n/*!****************************!*\\\n  !*** ./src/weakLoadURL.js ***!\n  \\****************************/\n/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {\n\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ weakLoadURL)\n/* harmony export */ });\n/**\n * Load a URL in Pjax way. Throw all errors.\n * @this {Pjax}\n * @param {string} url\n * @param {Partial<Pjax.options>} [overrideOptions]\n * @return {Promise<void>}\n */\nasync function weakLoadURL(url, overrideOptions = {}) {\n  var _this$abortController;\n\n  const parsedURL = new URL(url, document.URL); // External URL.\n\n  if (parsedURL.origin !== window.location.origin) {\n    throw new DOMException('Not same origin', 'SecurityError');\n  } // Store scroll position.\n\n\n  this.storeScrollPosition(); // Setup abort controller.\n\n  const abortController = new AbortController();\n  (_this$abortController = this.abortController) === null || _this$abortController === void 0 ? void 0 : _this$abortController.abort();\n  this.abortController = abortController; // Find path difference.\n\n  const targetPath = parsedURL.pathname + parsedURL.search;\n  const currentPath = this.location.pathname + this.location.search;\n\n  if (targetPath === currentPath) {\n    // Directly pushState on same path.\n    if (window.location.href !== parsedURL.href) {\n      window.history.pushState({}, document.title, parsedURL.href);\n    }\n\n    await this.preparePage(null, overrideOptions);\n  } else {\n    // Fetch and switch on different path.\n    await this.switchDOM(url, overrideOptions);\n  } // Update Pjax location and prepare the page.\n\n\n  this.history.pull();\n  this.location.href = window.location.href; // Finish, remove abort controller.\n\n  this.abortController = null;\n}\n\n/***/ })\n\n/******/ });\n/************************************************************************/\n/******/ // The module cache\n/******/ var __webpack_module_cache__ = {};\n/******/ \n/******/ // The require function\n/******/ function __webpack_require__(moduleId) {\n/******/ \t// Check if module is in cache\n/******/ \tvar cachedModule = __webpack_module_cache__[moduleId];\n/******/ \tif (cachedModule !== undefined) {\n/******/ \t\treturn cachedModule.exports;\n/******/ \t}\n/******/ \t// Create a new module (and put it into the cache)\n/******/ \tvar module = __webpack_module_cache__[moduleId] = {\n/******/ \t\t// no module.id needed\n/******/ \t\t// no module.loaded needed\n/******/ \t\texports: {}\n/******/ \t};\n/******/ \n/******/ \t// Execute the module function\n/******/ \t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n/******/ \n/******/ \t// Return the exports of the module\n/******/ \treturn module.exports;\n/******/ }\n/******/ \n/************************************************************************/\n/******/ /* webpack/runtime/define property getters */\n/******/ (() => {\n/******/ \t// define getter functions for harmony exports\n/******/ \t__webpack_require__.d = (exports, definition) => {\n/******/ \t\tfor(var key in definition) {\n/******/ \t\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n/******/ \t\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n/******/ \t\t\t}\n/******/ \t\t}\n/******/ \t};\n/******/ })();\n/******/ \n/******/ /* webpack/runtime/hasOwnProperty shorthand */\n/******/ (() => {\n/******/ \t__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))\n/******/ })();\n/******/ \n/******/ /* webpack/runtime/make namespace object */\n/******/ (() => {\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = (exports) => {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/ })();\n/******/ \n/************************************************************************/\nvar __webpack_exports__ = {};\n// This entry need to be wrapped in an IIFE because it need to be isolated against other modules in the chunk.\n(() => {\n/*!**********************!*\\\n  !*** ./src/index.js ***!\n  \\**********************/\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ \"./node_modules/@babel/runtime/helpers/esm/defineProperty.js\");\n/* harmony import */ var _libs_LazyHistory__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./libs/LazyHistory */ \"./src/libs/LazyHistory/index.js\");\n/* harmony import */ var _utils_Switches__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils/Switches */ \"./src/utils/Switches.js\");\n/* harmony import */ var _utils_DefaultTrigger__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils/DefaultTrigger */ \"./src/utils/DefaultTrigger.js\");\n/* harmony import */ var _switchDOM__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./switchDOM */ \"./src/switchDOM.js\");\n/* harmony import */ var _preparePage__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./preparePage */ \"./src/preparePage.js\");\n/* harmony import */ var _weakLoadURL__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./weakLoadURL */ \"./src/weakLoadURL.js\");\n\n\n\n\n\n\n\n\nclass Pjax {\n  static reload() {\n    window.location.reload();\n  }\n  /**\n   * Pjax options.\n   * @property {boolean} defaultTrigger\n   * @property {Array<string>} selectors\n   * @property {Object<string, Pjax.Switch>} switches\n   * @property {string} scripts\n   * @property {number | number[] | boolean} scrollTo\n   * @property {boolean} scrollRestoration\n   * @property {RequestCache} cacheMode\n   * @property {number} timeout\n   */\n\n\n  /**\n   * @param {Partial<Pjax.options>} options\n   */\n  constructor(options = {}) {\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"options\", {\n      defaultTrigger: true,\n      selectors: ['title', '.pjax'],\n      switches: {},\n      scripts: 'script[data-pjax]',\n      scrollTo: true,\n      scrollRestoration: true,\n      cacheMode: 'default',\n      timeout: 0\n    });\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"history\", new _libs_LazyHistory__WEBPACK_IMPORTED_MODULE_1__.default('pjax'));\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"location\", new URL(window.location.href));\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"abortController\", null);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"switchDOM\", _switchDOM__WEBPACK_IMPORTED_MODULE_4__.default);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"preparePage\", _preparePage__WEBPACK_IMPORTED_MODULE_5__.default);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"weakLoadURL\", _weakLoadURL__WEBPACK_IMPORTED_MODULE_6__.default);\n\n    Object.assign(this.options, options);\n\n    if (this.options.scrollRestoration) {\n      window.history.scrollRestoration = 'manual'; // Browsers' own restoration is faster and more stable on reload.\n\n      window.addEventListener('beforeunload', () => {\n        window.history.scrollRestoration = 'auto';\n      });\n    }\n\n    if (this.options.defaultTrigger) new _utils_DefaultTrigger__WEBPACK_IMPORTED_MODULE_3__.default(this).register();\n    window.addEventListener('popstate', event => {\n      /**\n       * The main reason why we write the LazyHistory library is right here:\n       * `window.history.state` is ALREADY changed on popstate events and\n       * we can't update the previous state anymore. (For scroll position, etc.)\n       * As continuously updating `window.history.state` causes performance issues,\n       * using a custom library seems to be the only choice.\n       */\n      // Store scroll position and then update the lazy state.\n      this.storeScrollPosition();\n      this.history.pull(); // hashchange events trigger popstate with a null `event.state`.\n\n      if (event.state === null) return;\n      const overrideOptions = {};\n\n      if (this.options.scrollRestoration && 'scrollPos' in this.history.state) {\n        overrideOptions.scrollTo = this.history.state.scrollPos;\n      }\n\n      this.loadURL(window.location.href, overrideOptions).catch(() => {});\n    });\n  }\n\n  storeScrollPosition() {\n    this.history.state.scrollPos = [window.scrollX, window.scrollY];\n  }\n  /**\n   * Fire Pjax related events.\n   * @param {'send'|'error'|'success'|'complete'} type\n   * @param {Object} detail\n   */\n\n\n  fire(type, detail) {\n    const event = new CustomEvent(`pjax:${type}`, {\n      bubbles: true,\n      cancelable: false,\n      detail: {\n        abortController: this.abortController,\n        ...detail\n      }\n    });\n    document.dispatchEvent(event);\n  }\n\n  /**\n   * Load a URL in Pjax way. Navigate normally on errors except AbortError.\n   * @param {string} url\n   * @param {Partial<Pjax.options>} [overrideOptions]\n   * @return {Promise<void>}\n   */\n  async loadURL(url, overrideOptions = {}) {\n    try {\n      await this.weakLoadURL(url, overrideOptions);\n    } catch (e) {\n      if (e.name === 'AbortError') throw e;\n      window.location.assign(url);\n    }\n  }\n\n}\n\n(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(Pjax, \"switches\", _utils_Switches__WEBPACK_IMPORTED_MODULE_2__.default);\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Pjax);\n})();\n\nvar __webpack_exports__default = __webpack_exports__.default;\nexport { __webpack_exports__default as default };\n\n//# sourceMappingURL=pjax.esm.js.map"],"sourceRoot":""}