/*! For license information please see 766.js.LICENSE.txt */
(self.webpackChunksakurairo_scripts=self.webpackChunksakurairo_scripts||[]).push([[766],{7766:(t,e,s)=>{s.r(e),s.d(e,{default:()=>n});var r={"./node_modules/@babel/runtime/helpers/esm/classPrivateMethodGet.js":(t,e,s)=>{function r(t,e,s){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return s}s.r(e),s.d(e,{default:()=>r})},"./node_modules/@babel/runtime/helpers/esm/defineProperty.js":(t,e,s)=>{function r(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}s.r(e),s.d(e,{default:()=>r})},"./src/libs/LazyHistory/index.js":(t,e,s)=>{s.r(e),s.d(e,{default:()=>c});var r=s("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=s("./node_modules/@babel/runtime/helpers/esm/classPrivateMethodGet.js"),o=new WeakSet,n=new WeakSet;function a(){window.sessionStorage.setItem(this.sessionKey,JSON.stringify(this.state))}function l(t=window.history.state){(0,i.default)(this,o,a).call(this);const e=`${this.idPrefix}_${this.count}`;this.count+=1;const s={...t||{},[this.historyKey]:e};return this.sessionKey=e,this.state=s,s}const c=class{constructor(t,e=t){n.add(this),o.add(this),(0,r.default)(this,"idPrefix",void 0),(0,r.default)(this,"count",0),(0,r.default)(this,"historyKey",void 0),(0,r.default)(this,"sessionKey",void 0),(0,r.default)(this,"state",void 0),this.idPrefix=t,this.historyKey=e,window.history.replaceState((0,i.default)(this,n,l).call(this),document.title)}push(t,e,s){window.history.pushState((0,i.default)(this,n,l).call(this,t),e,s)}pull(){var t;(0,i.default)(this,o,a).call(this);const e=null===(t=window.history.state)||void 0===t?void 0:t[this.historyKey];e?(this.sessionKey=e,this.state=JSON.parse(window.sessionStorage.getItem(e))):window.history.replaceState((0,i.default)(this,n,l).call(this),document.title)}}},"./src/libs/executeScripts/Script.js":(t,e,s)=>{s.r(e),s.d(e,{default:()=>i});const r=["application/ecmascript","application/javascript","application/x-ecmascript","application/x-javascript","text/ecmascript","text/javascript","text/javascript1.0","text/javascript1.1","text/javascript1.2","text/javascript1.3","text/javascript1.4","text/javascript1.5","text/jscript","text/livescript","text/x-ecmascript","text/x-javascript"];const i=class{constructor(t){if(this.evaluable=!1,this.external=!1,this.target=t,!t.hasAttribute("src")&&!t.text)return;const e=t.type?t.type.trim():"text/javascript";if(r.includes(e))this.type="classic";else{if("module"!==e)return;this.type="module"}if(!t.noModule||"classic"!==this.type){if(t.hasAttribute("src")){const e=t.getAttribute("src");if(!e)return;this.external=!0;try{new URL(e,document.URL)}catch{return}}this.blocking=!0,("classic"!==this.type||this.external&&(t.hasAttribute("async")||t.hasAttribute("defer")))&&(this.blocking=!1),this.evaluable=!0}}eval(){return new Promise(((t,e)=>{const s=this.target,r=document.createElement("script");r.addEventListener("error",e),s.getAttributeNames().forEach((t=>{r.setAttribute(t,s.getAttribute(t))})),r.text=s.text,this.external&&(r.hasAttribute("async")||(r.async=!1),r.defer=!1),document.contains(s)?s.replaceWith(r):(document.head.append(r),this.external?r.addEventListener("load",(()=>r.remove())):r.remove()),this.external?r.addEventListener("load",t):t()}))}}},"./src/libs/executeScripts/index.js":(t,e,s)=>{s.r(e),s.d(e,{default:()=>o});var r=s("./src/libs/executeScripts/Script.js");class i{constructor(t){this.signal=t}async exec(t){var e;if(null!==(e=this.signal)&&void 0!==e&&e.aborted)throw new DOMException("Execution aborted","AbortError");const s=t.eval().catch((()=>{}));t.blocking&&await s}}async function o(t,{signal:e}={}){if(null!=e&&e.aborted)throw new DOMException("Aborted execution","AbortError");const s=Array.from(t,(t=>new r.default(t))).filter((t=>t.evaluable)),o=new i(e),n=s.reduce(((t,e)=>e.external?Promise.all([t,o.exec(e)]):t.then((()=>o.exec(e)))),Promise.resolve());return Promise.race([n,new Promise(((t,s)=>{null==e||e.addEventListener("abort",(()=>{s(new DOMException("Aborted execution","AbortError"))}))}))])}},"./src/preparePage.js":(t,e,s)=>{s.r(e),s.d(e,{default:()=>i});var r=s("./src/libs/executeScripts/index.js");async function i(t,e={}){const s={...this.options,...e};if(t){var i,o;if(t.focusCleared)null===(o=document.querySelectorAll("[autofocus]")[0])||void 0===o||o.focus();const e=[...document.querySelectorAll(s.scripts)].filter((t=>t instanceof HTMLScriptElement));s.selectors.forEach((t=>{document.body.querySelectorAll(t).forEach((t=>{t.querySelectorAll("script").forEach((t=>{e.includes(t)||e.push(t)}))}))})),e.sort(((t,e)=>t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_PRECEDING||-1)),await(0,r.default)(e,{signal:null===(i=this.abortController)||void 0===i?void 0:i.signal})}const{scrollTo:n}=s;if(!1!==n){let e=!!t&&[0,0];if(Array.isArray(n))e=n;else if("number"==typeof n)e=[window.scrollX,n];else{const t=decodeURIComponent(window.location.hash.slice(1));if(t){const s=document.getElementById(t)||document.getElementsByName(t)[0];s&&(s.scrollIntoView(),e=!1)}}e&&window.scrollTo(e[0],e[1])}}},"./src/switchDOM.js":(t,e,s)=>{s.r(e),s.d(e,{default:()=>i});var r=s("./src/utils/switchNodes.js");async function i(t,e={}){var s;const{selectors:i,switches:o,timeout:n}={...this.options,...e},a={},l=new URL(t,document.URL);a.targetURL=l.href;const c=(null===(s=this.abortController)||void 0===s?void 0:s.signal)||null;a.signal=c,a.selectors=i;const d=new Request(l.href,{headers:{"X-Requested-With":"Fetch","X-Pjax":"true","X-Pjax-Selectors":JSON.stringify(i)},signal:c});a.timeout=n;let u=null;n>0&&(u=window.setTimeout((()=>{var t;null===(t=this.abortController)||void 0===t||t.abort()}),n),a.timeoutID=u),this.fire("send",a);try{const t=await fetch(d).finally((()=>{window.clearTimeout(u)})),s=(new DOMParser).parseFromString(await t.text(),"text/html");a.switches=o;const n=await(0,r.default)(s,{selectors:i,switches:o,signal:c});a.switchResult=n;const h=new URL(t.url);h.hash=l.hash,window.location.href!==h.href&&window.history.pushState({},document.title,h.href),await this.preparePage(n,e)}catch(t){throw a.error=t,this.fire("error",a),t}finally{this.fire("complete",a)}this.fire("success",a)}},"./src/utils/DefaultTrigger.js":(t,e,s)=>{s.r(e),s.d(e,{default:()=>o});var r=s("./node_modules/@babel/runtime/helpers/esm/defineProperty.js");const i=t=>{let e=t;const s=[...document.links];for(;!s.includes(e);){const t=e.parentElement;if(!t)return null;e=t}return e};class o{constructor(t){(0,r.default)(this,"pjax",void 0),this.pjax=t}onLinkOpen(t,e){t.defaultPrevented||(t instanceof MouseEvent||t instanceof KeyboardEvent)&&(t.metaKey||t.ctrlKey||t.shiftKey||t.altKey)||e.origin===window.location.origin&&(t.preventDefault(),this.pjax.loadURL(e.href).catch((()=>{})))}register(){document.addEventListener("click",(t=>{const e=i(t.target);e&&this.onLinkOpen(t,e)})),document.addEventListener("keyup",(t=>{if("Enter"!==t.key)return;const e=i(t.target);e&&this.onLinkOpen(t,e)}))}}},"./src/utils/Switches.js":(t,e,s)=>{s.r(e),s.d(e,{default:()=>i});const r={async innerHTML(t,e){t.innerHTML=e.innerHTML},async textContent(t,e){t.textContent=e.textContent},async innerText(t,e){t.innerText=e.innerText},async attributes(t,e){let s=t.getAttributeNames();e.getAttributeNames().forEach((r=>{t.setAttribute(r,e.getAttribute(r)),s=s.filter((t=>t!==r))})),s.forEach((e=>{t.removeAttribute(e)}))},async replaceWith(t,e){t.replaceWith(e)}};r.default=r.replaceWith;const i=r},"./src/utils/switchNodes.js":(t,e,s)=>{s.r(e),s.d(e,{default:()=>i});var r=s("./src/utils/Switches.js");async function i(t,{selectors:e,switches:s,signal:i}){if(null!=i&&i.aborted)throw new DOMException("Aborted switches","AbortError");let o=!1;const n=[];e.forEach((e=>{const i=t.querySelectorAll(e),a=document.querySelectorAll(e);if(i.length!==a.length)throw new DOMException(`Selector '${e}' does not select the same amount of nodes`,"IndexSizeError");a.forEach(((t,a)=>{!o&&document.activeElement&&t.contains(document.activeElement)&&(document.activeElement.blur(),o=!0);const l=(null==s?void 0:s[e])||r.default.default,c=Promise.resolve().then((()=>l(t,i[a]))).catch((()=>{}));n.push(c)}))}));const a=await Promise.race([Promise.all(n),new Promise(((t,e)=>{null==i||i.addEventListener("abort",(()=>{e(new DOMException("Aborted switches","AbortError"))}))}))]);return{focusCleared:o,outcomes:a}}},"./src/weakLoadURL.js":(t,e,s)=>{async function r(t,e={}){var s;const r=new URL(t,document.URL);if(r.origin!==window.location.origin)throw new DOMException("Not same origin","SecurityError");this.storeScrollPosition();const i=new AbortController;null===(s=this.abortController)||void 0===s||s.abort(),this.abortController=i;r.pathname+r.search===this.location.pathname+this.location.search?(window.location.href!==r.href&&window.history.pushState({},document.title,r.href),await this.preparePage(null,e)):await this.switchDOM(t,e),this.history.pull(),this.location.href=window.location.href,this.abortController=null}s.r(e),s.d(e,{default:()=>r})}},i={};function o(t){var e=i[t];if(void 0!==e)return e.exports;var s=i[t]={exports:{}};return r[t](s,s.exports,o),s.exports}o.d=(t,e)=>{for(var s in e)o.o(e,s)&&!o.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};e={};(()=>{o.r(e),o.d(e,{default:()=>d});var t=o("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=o("./src/libs/LazyHistory/index.js"),r=o("./src/utils/Switches.js"),i=o("./src/utils/DefaultTrigger.js"),n=o("./src/switchDOM.js"),a=o("./src/preparePage.js"),l=o("./src/weakLoadURL.js");class c{static reload(){window.location.reload()}constructor(e={}){(0,t.default)(this,"options",{defaultTrigger:!0,selectors:["title",".pjax"],switches:{},scripts:"script[data-pjax]",scrollTo:!0,scrollRestoration:!0,cacheMode:"default",timeout:0}),(0,t.default)(this,"history",new s.default("pjax")),(0,t.default)(this,"location",new URL(window.location.href)),(0,t.default)(this,"abortController",null),(0,t.default)(this,"switchDOM",n.default),(0,t.default)(this,"preparePage",a.default),(0,t.default)(this,"weakLoadURL",l.default),Object.assign(this.options,e),this.options.scrollRestoration&&(window.history.scrollRestoration="manual",window.addEventListener("beforeunload",(()=>{window.history.scrollRestoration="auto"}))),this.options.defaultTrigger&&new i.default(this).register(),window.addEventListener("popstate",(t=>{if(this.storeScrollPosition(),this.history.pull(),null===t.state)return;const e={};this.options.scrollRestoration&&"scrollPos"in this.history.state&&(e.scrollTo=this.history.state.scrollPos),this.loadURL(window.location.href,e).catch((()=>{}))}))}storeScrollPosition(){this.history.state.scrollPos=[window.scrollX,window.scrollY]}fire(t,e){const s=new CustomEvent(`pjax:${t}`,{bubbles:!0,cancelable:!1,detail:{abortController:this.abortController,...e}});document.dispatchEvent(s)}async loadURL(t,e={}){try{await this.weakLoadURL(t,e)}catch(e){if("AbortError"===e.name)throw e;window.location.assign(t)}}}(0,t.default)(c,"switches",r.default);const d=c})();var n=e.default}}]);
//# sourceMappingURL=766.js.map